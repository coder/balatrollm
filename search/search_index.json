{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"BalatroLLM","text":"BalatroBot API for developing Balatro bots BalatroLLM Play Balatro with LLMs BalatroBench Benchmark LLMs playing Balatro <p>BalatroLLM is a bot that uses Large Language Models (LLMs) to play Balatro, the popular roguelike poker deck-building game. The bot analyzes game states, makes strategic decisions, and executes actions through the BalatroBot API.</p> <ul> <li> <p> Installation</p> <p>Installation guide covering dependencies, environment setup, and API key configuration.</p> <p> Installation</p> </li> <li> <p> CLI Reference</p> <p>Reference for the <code>balatrollm</code> command-line interface, options, and usage examples.</p> <p> CLI Reference</p> </li> <li> <p> Strategies</p> <p>Learn how strategies work, their structure using Jinja2 templates, and how to contribute your own.</p> <p> Strategies</p> </li> <li> <p> Contributing</p> <p>Guide for contributing to BalatroLLM development, including setup and coding standards.</p> <p> Contributing</p> </li> <li> <p> Documentation for LLM</p> <p>Docs in llms.txt format. Paste the following link (or its content) into the LLM.</p> <p> llms-full.txt</p> </li> </ul>"},{"location":"cli/","title":"CLI Reference","text":"<p>Reference for the <code>balatrollm</code> command-line interface.</p>"},{"location":"cli/#usage","title":"Usage","text":"<pre><code>balatrollm [CONFIG] [OPTIONS]\n</code></pre> <p>BalatroLLM can be configured through three methods with the following precedence (lowest to highest):</p> <ol> <li>Environment variables - <code>BALATROLLM_*</code> prefixed variables</li> <li>Configuration file - YAML file (see <code>config/example.yaml</code>)</li> <li>CLI flags - Command-line arguments (highest precedence)</li> </ol> <p>This means CLI flags override config file values, which override environment variables.</p>"},{"location":"cli/#arguments","title":"Arguments","text":"Argument Required Description <code>CONFIG</code> No Path to YAML configuration file <p>BALATROLLM_CONFIG Environment Variable</p> <p>The configuration file path can also be specified via the <code>BALATROLLM_CONFIG</code> environment variable:</p> <pre><code>export BALATROLLM_CONFIG=\"config/example.yaml\"\nbalatrollm\n</code></pre> <p>This is the only <code>BALATROLLM_*</code> environment variable that does not have a corresponding CLI flag \u2014 the user can simply provide the config file path as a positional argument instead.</p> <p>Precedence: If both the <code>CONFIG</code> argument and <code>BALATROLLM_CONFIG</code> are provided, the CLI argument takes precedence and <code>BALATROLLM_CONFIG</code> is ignored.</p>"},{"location":"cli/#configuration-file-yaml","title":"Configuration file (YAML)","text":"<p>The YAML configuration file uses the same field names as the CLI flags (minus the <code>--</code>), for example:</p> <ul> <li>CLI <code>--model</code> \u2192 YAML <code>model</code></li> <li>CLI <code>--base-url</code> \u2192 YAML <code>base_url</code></li> </ul> <p>For a full annotated example, see <code>config/example.yaml</code>.</p>"},{"location":"cli/#model-required","title":"<code>model</code> (required)","text":"<p><code>model</code> is required, but it can come from any config source (YAML config, env var, or CLI flag). If you set <code>model:</code> in your YAML file, you do not need to also pass <code>--model</code>.</p> <pre><code>model:\n  - openai/gpt-4o\n</code></pre>"},{"location":"cli/#model_config-advanced","title":"<code>model_config</code> (advanced)","text":"<p>The YAML file also supports an optional <code>model_config</code> mapping for advanced provider/model request knobs. BalatroLLM deep-merges your <code>model_config</code> into built-in defaults (including nested fields like <code>extra_headers</code> and <code>extra_body</code>) and then passes the result directly to the OpenAI-compatible chat completions request.</p> <p>Common examples include <code>temperature</code>, <code>max_tokens</code>, <code>seed</code>, <code>parallel_tool_calls</code>, <code>tool_choice</code>, plus provider-specific settings via <code>extra_body</code> (e.g., OpenRouter).</p> <pre><code>model_config:\n  temperature: 0.2\n  max_tokens: 2048\n  extra_body:\n    reasoning:\n      effort: medium\n</code></pre>"},{"location":"cli/#options","title":"Options","text":"CLI Flag Environment Variable Default Description <code>--model MODEL</code> <code>BALATROLLM_MODEL</code> (required) LLM model(s) to use (or set <code>model:</code> in YAML) <code>--seed SEED</code> <code>BALATROLLM_SEED</code> <code>AAAAAAA</code> Game seed(s) <code>--deck DECK</code> <code>BALATROLLM_DECK</code> <code>RED</code> Deck code(s) <code>--stake STAKE</code> <code>BALATROLLM_STAKE</code> <code>WHITE</code> Stake code(s) <code>--strategy STRATEGY</code> <code>BALATROLLM_STRATEGY</code> <code>default</code> Strategy name(s) <code>--parallel N</code> <code>BALATROLLM_PARALLEL</code> <code>1</code> Concurrent game instances <code>--host HOST</code> <code>BALATROLLM_HOST</code> <code>127.0.0.1</code> BalatroBot host <code>--port PORT</code> <code>BALATROLLM_PORT</code> <code>12346</code> Starting port <code>--base-url URL</code> <code>BALATROLLM_BASE_URL</code> <code>https://openrouter.ai/api/v1</code> LLM API base URL <code>--api-key KEY</code> <code>BALATROLLM_API_KEY</code> None LLM API key <code>--views</code> <code>BALATROLLM_VIEWS</code> <code>False</code> Enable views HTTP server (set <code>BALATROLLM_VIEWS=1</code>) <code>--dry-run</code> - <code>False</code> Show tasks without executing <p>How Balatro instances are started</p> <p><code>balatrollm</code> starts/stops Balatro instances automatically via <code>balatrobot</code>. With <code>--parallel N</code>, it spawns instances on ports <code>--port</code> through <code>--port + N - 1</code> (<code>port..port+parallel-1</code>). When using <code>--parallel N</code>, N workers are spawned. In order to fully utilize you have to have more tasks than workers. Check out th number of tasks that will be created using the <code>--dry-run</code> option.</p> <p>Multiple Values</p> <p>Options marked with \"model(s)\", \"seed(s)\", etc. accept multiple values. When multiple values are provided, BalatroLLM generates a cartesian product of all combinations as tasks.</p> <p>The following values can be provided for <code>deck</code> and <code>stake</code> options:</p> <ul> <li>Decks: <code>RED</code>, <code>BLUE</code>, <code>YELLOW</code>, <code>GREEN</code>, <code>BLACK</code>, <code>MAGIC</code>, <code>NEBULA</code>, <code>GHOST</code>, <code>ABANDONED</code>, <code>CHECKERED</code>, <code>ZODIAC</code>, <code>PAINTED</code>, <code>ANAGLYPH</code>, <code>PLASMA</code>, <code>ERRATIC</code></li> <li>Stakes: <code>WHITE</code>, <code>RED</code>, <code>GREEN</code>, <code>BLACK</code>, <code>BLUE</code>, <code>PURPLE</code>, <code>ORANGE</code>, <code>GOLD</code></li> <li>Seeds: no strict rules but it is suggested to follow the regex <code>^[1-9A-Z]{1,8}$</code> for deterministic results.</li> </ul>"},{"location":"cli/#examples","title":"Examples","text":""},{"location":"cli/#basic-usage","title":"Basic Usage","text":"<pre><code># Run with specific model (requires BALATROLLM_API_KEY in environment)\nbalatrollm --model openai/gpt-5\n\n# Run with configuration file\nbalatrollm config/example.yaml\n\n# Run with configuration file via environment variable\nexport BALATROLLM_CONFIG=\"config/example.yaml\"\nbalatrollm\n\n# Run with config file and override specific options\nbalatrollm config/example.yaml --model openai/gpt-5 --seed BBBBBBB\n</code></pre>"},{"location":"cli/#advanced-usage","title":"Advanced Usage","text":"<pre><code># Multiple seeds and decks (generates cartesian product of all combinations)\nbalatrollm --model openai/gpt-5 --deck RED BLUE --seed AAAAAAA BBBBBBB\n\n# Run multiple game instances concurrently (2 workers, 1 model x 3 seed = 3 tasks)\nbalatrollm --model openai/gpt-5 --parallel 2 --seed AAAAAAA BBBBBBB CCCCCCC\n\n# Preview tasks without executing\nbalatrollm config/example.yaml --dry-run\n\n# Use a custom strategy\nbalatrollm --model openai/gpt-4o --strategy my_custom_strategy\n\n# Enable views overlay on port 12345\nbalatrollm --model openai/gpt-4o --views\n\n# Enable views overlay via environment variable (0/1)\nBALATROLLM_VIEWS=1 balatrollm --model openai/gpt-4o\n# Access views at:\n#   http://localhost:12345/views/task.html\n#   http://localhost:12345/views/responses.html\n</code></pre> <p>Cartesian Product</p> <p>When specifying multiple values for seeds, decks, stakes, etc., BalatroLLM generates all combinations as separate tasks. For example, <code>--deck RED BLUE --seed AAAAAAA BBBBBBB</code> creates 4 tasks: <code>(RED, AAAAAAA)</code>, <code>(RED, BBBBBBB)</code>, <code>(BLUE, AAAAAAA)</code>, <code>(BLUE, BBBBBBB)</code>. For complex task configurations, use a YAML configuration file.</p> <p>For more information about strategies, see the Strategies documentation.</p>"},{"location":"cli/#run-artifacts-outputs","title":"Run artifacts / outputs","text":"<p><code>balatrollm</code> writes run artifacts to <code>./runs/</code> (relative to your current working directory).</p> <pre><code>runs/\n  latest.json\n  vX.Y.Z/&lt;strategy&gt;/&lt;vendor&gt;/&lt;model&gt;/&lt;timestamp&gt;_&lt;deck&gt;_&lt;stake&gt;_&lt;seed&gt;/\n    task.json\n    strategy.json\n    run.log\n    requests.jsonl\n    responses.jsonl\n    gamestates.jsonl\n    stats.json\n    screenshots/\n</code></pre> <ul> <li><code>task.json</code> / <code>strategy.json</code>: resolved task metadata and the strategy manifest used for the run.</li> <li><code>requests.jsonl</code> / <code>responses.jsonl</code>: LLM requests and responses (JSONL, one object per line).</li> <li><code>gamestates.jsonl</code>: game state snapshots after each action.</li> <li><code>stats.json</code>: aggregated statistics for the run.</li> <li><code>screenshots/</code>: screenshots captured during the run.</li> <li><code>run.log</code>: logs captured during the run.</li> <li><code>runs/latest.json</code>: updated each run; used by the <code>--views</code> overlays to locate the latest <code>task.json</code> and <code>responses.jsonl</code>.</li> </ul>"},{"location":"cli/#balatrobot-configuration","title":"BalatroBot Configuration","text":"<p>BalatroBot instances spawned by BalatroLLM can be configured through <code>BALATROBOT_*</code> environment variables. These settings control how Balatro runs during automated gameplay.</p> Environment Variable Default Description <code>BALATROBOT_HOST</code> <code>127.0.0.1</code> Server hostname <code>BALATROBOT_PORT</code> <code>12346</code> Server port <code>BALATROBOT_FAST</code> <code>0</code> Enable fast mode (10x game speed) <code>BALATROBOT_HEADLESS</code> <code>0</code> Enable headless mode (minimal rendering) <code>BALATROBOT_RENDER_ON_API</code> <code>0</code> Render only on API calls <code>BALATROBOT_AUDIO</code> <code>0</code> Enable audio <code>BALATROBOT_DEBUG</code> <code>0</code> Enable debug mode (requires DebugPlus mod) <code>BALATROBOT_NO_SHADERS</code> <code>0</code> Disable all shaders <code>BALATROBOT_BALATRO_PATH</code> auto-detected Path to Balatro game directory <code>BALATROBOT_LOVELY_PATH</code> auto-detected Path to lovely library (dll/so/dylib) <code>BALATROBOT_LOVE_PATH</code> auto-detected Path to LOVE executable (native only) <code>BALATROBOT_PLATFORM</code> auto-detected Platform: darwin, linux, windows, native <code>BALATROBOT_LOGS_PATH</code> <code>logs</code> Directory for log files <p>For detailed information about platform-specific behavior and configuration, see the BalatroBot Platform-Specific Details</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Guide for contributing to BalatroLLM development.</p>"},{"location":"contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Balatro (v1.0.1+) - Purchase from Steam</li> <li>BalatroBot (latest) - Follow the installation guide</li> <li>Uv (v0.9.21+) - Follow the installation guide</li> <li>LLM API access - Obtain API key from an OpenAI-compatible provider (e.g., OpenRouter, OpenAI)</li> </ul>"},{"location":"contributing/#development-environment-setup","title":"Development Environment Setup","text":""},{"location":"contributing/#direnv-recommended","title":"direnv (Recommended)","text":"<p>We use direnv to automatically manage environment variables and virtual environment activation. When you <code>cd</code> into the project directory, direnv automatically loads settings from <code>.envrc</code>.</p> <p>Contains Secrets</p> <p>The <code>.envrc</code> file may contain API keys. Never commit this file.</p> <p>Start from the versioned template:</p> <pre><code>cp .envrc.example .envrc\ndirenv allow\n</code></pre> <p>Then edit <code>.envrc</code> and set at minimum <code>BALATROLLM_API_KEY</code> (and <code>BALATROLLM_MODEL</code> if you aren't providing a YAML config or <code>--model</code>).</p>"},{"location":"contributing/#development-setup","title":"Development Setup","text":""},{"location":"contributing/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>git clone https://github.com/coder/balatrollm.git\ncd balatrollm\n</code></pre>"},{"location":"contributing/#2-install-dependencies","title":"2. Install Dependencies","text":"<pre><code>make install\n</code></pre>"},{"location":"contributing/#3-activate-virtual-environment","title":"3. Activate Virtual Environment","text":"<pre><code>source .venv/bin/activate\n</code></pre>"},{"location":"contributing/#available-make-commands","title":"Available Make Commands","text":"<p>The project includes a Makefile with convenient targets for common development tasks:</p> <pre><code>make help      # Show all available commands\nmake install   # Install dependencies\nmake lint      # Run ruff linter\nmake format    # Format code (Python, Markdown)\nmake typecheck # Run type checker (ty)\nmake quality   # Run all code quality checks\nmake test      # Run all tests (unit + integration)\nmake all       # Run quality checks and tests\n</code></pre>"},{"location":"contributing/#running-tests","title":"Running Tests","text":"<p>Tests use Python + pytest to verify bot functionality. You don't need to have BalatroBot running\u2014the tests automatically start the required Balatro instances.</p> <p>Separate Unit and Integration Test Suites</p> <p>The unit and integration test suites are run in sequence. Unit tests run first without Balatro, followed by integration tests that spawn Balatro instances.</p> <pre><code># Install all dependencies\nmake install\n\n# Run all tests (unit + integration in sequence)\nmake test\n\n# Run unit tests only (no Balatro required)\npytest tests/unit\n\n# Run integration tests (starts Balatro instances)\n# Runs with 2 workers in parallel\nBALATROBOT_RENDER_ON_API=0 BALATROBOT_HEADLESS=1 pytest -n 2 tests/integration\n\n# Run specific test file\npytest tests/unit/test_config.py -v\n\n# Run tests with dev marker only\npytest tests/unit -m dev\n\n# Run only integration tests\npytest tests/integration -m integration\n\n# Run tests that do not require Balatro instance\npytest tests/unit -m \"not integration\"\n</code></pre> <p>Test markers:</p> <ul> <li><code>@pytest.mark.dev</code>: Run only tests under development with <code>-m dev</code></li> <li><code>@pytest.mark.integration</code>: Tests that start Balatro (skip with <code>-m \"not integration\"</code>)</li> </ul>"},{"location":"contributing/#code-structure","title":"Code Structure","text":"<pre><code>src/balatrollm/\n\u251c\u2500\u2500 cli.py           # CLI entry point and argument parsing\n\u251c\u2500\u2500 bot.py           # Core game loop with LLM decision-making\n\u251c\u2500\u2500 client.py        # BalatroBot JSON-RPC client\n\u251c\u2500\u2500 llm.py           # OpenAI client wrapper with retry logic\n\u251c\u2500\u2500 strategy.py      # Strategy template management\n\u251c\u2500\u2500 config.py        # Multi-source configuration management\n\u251c\u2500\u2500 executor.py      # Parallel execution orchestration\n\u251c\u2500\u2500 collector.py     # Data collection and statistics\n\u2514\u2500\u2500 strategies/      # Strategy templates\n    \u2514\u2500\u2500 default/\n        \u251c\u2500\u2500 manifest.json         # Strategy metadata\n        \u251c\u2500\u2500 STRATEGY.md.jinja     # Game rules and tactics\n        \u251c\u2500\u2500 GAMESTATE.md.jinja    # Current state template\n        \u251c\u2500\u2500 MEMORY.md.jinja       # Action history template\n        \u2514\u2500\u2500 TOOLS.json            # Function calling tools\n</code></pre>"},{"location":"contributing/#code-quality","title":"Code Quality","text":"<p>Before committing, always run:</p> <pre><code>make quality  # Runs lint, typecheck, and format\n</code></pre> <p>This ensures your code meets the project's quality standards:</p> <ul> <li>Linting: <code>ruff check</code> for Python code style</li> <li>Formatting: <code>ruff format</code> for Python, <code>mdformat</code> for Markdown</li> <li>Type checking: <code>ty check</code> for static type analysis</li> </ul>"},{"location":"contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<ol> <li>One feature per PR - Keep changes focused</li> <li>Add tests - New functionality needs test coverage</li> <li>Update docs - Update documentation for user-facing changes</li> <li>Run code quality checks - Execute <code>make quality</code> before committing</li> <li>Test locally - Ensure both unit and integration tests pass</li> <li>Use Conventional Commits - Follow Conventional Commits for automated changelog generation</li> </ol>"},{"location":"contributing/#cicd-pipeline","title":"CI/CD Pipeline","text":"<p>The project uses GitHub Actions for continuous integration and deployment.</p>"},{"location":"contributing/#workflows","title":"Workflows","text":"<ul> <li>code-quality.yml: Runs linting, type checking, and formatting on every PR (equivalent to <code>make quality</code>)</li> <li>deploy-docs.yml: Deploys documentation to GitHub Pages when changes are pushed to main</li> <li>release-please.yml: Automated version management and changelog generation</li> <li>release-pypi.yml: Publishes the package to PyPI when a release tag is created</li> <li>commit_lint.yml: Validates commit messages follow Conventional Commits format</li> <li>update-balatrobot-dependency.yml: Automatically updates BalatroBot dependency</li> </ul>"},{"location":"contributing/#for-contributors","title":"For Contributors","text":"<p>You don't need to worry about most CI/CD workflows\u2014just ensure your PR passes the code quality checks:</p> <pre><code>make quality  # Run this before pushing\n</code></pre> <p>If CI fails on your PR, check the workflow logs on GitHub for details. Most issues can be fixed by running <code>make quality</code> locally.</p>"},{"location":"contributing/#contributing-strategies","title":"Contributing Strategies","text":"<p>See Strategies for how to create and contribute custom playing strategies.</p>"},{"location":"installation/","title":"Installation","text":"<p>This guide will help you install and configure BalatroLLM.</p>"},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Balatro (v1.0.1+) - Purchase from Steam</li> <li>BalatroBot (latest) - Follow the installation guide</li> <li>Uv (v0.9.21+) - Follow the installation guide</li> <li>LLM API access - Obtain API key from an OpenAI-compatible provider (e.g., OpenRouter, OpenAI)</li> </ul> <p>Tool Use (Function Calling) Required</p> <p>The LLM model you choose must support tool use (also known as function calling). BalatroLLM relies on tool calls to execute game actions \u2014 models without this capability will not work.</p> <p>Most frontier models (e.g., GPT-4o, Claude, Gemini) support tool use, but smaller or older models may not. Check your provider's documentation to confirm support.</p> <p>BalatroBot Setup Required</p> <p>Setting up Balatro with the BalatroBot mod requires careful configuration. Please follow the BalatroBot Installation Guide step by step.</p> <p>Ensure BalatroBot is installed and working before proceeding with BalatroLLM installation.</p>"},{"location":"installation/#installation_1","title":"Installation","text":""},{"location":"installation/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>git clone --depth 1 https://github.com/coder/balatrollm.git\ncd balatrollm\n</code></pre>"},{"location":"installation/#2-create-environment-and-install-dependencies","title":"2. Create Environment and Install Dependencies","text":"<pre><code>uv sync --no-dev\n</code></pre> <p>When running <code>uv sync</code>, uv automatically downloads the required Python version, creates a new environment at <code>.venv</code>, and installs the project dependencies.</p>"},{"location":"installation/#3-activate-environment","title":"3. Activate Environment","text":"<pre><code>source .venv/bin/activate\n</code></pre>"},{"location":"installation/#4-verify-installation","title":"4. Verify Installation","text":"<pre><code>balatrollm --help\n</code></pre> <p>Auto venv activation</p> <p>You can use direnv to automatically activate the environment when you enter the project directory. See the <code>.envrc.example</code> file for an example configuration.</p>"},{"location":"installation/#provider-configuration","title":"Provider Configuration","text":"<p>Configure your LLM provider through environment variables. We recommend using <code>.envrc</code> (see <code>.envrc.example</code>):</p> <pre><code>export BALATROLLM_BASE_URL=\"https://openrouter.ai/api/v1\"\nexport BALATROLLM_API_KEY=\"sk-...\"\n</code></pre> Variable Description <code>BALATROLLM_BASE_URL</code> API base URL (e.g., OpenRouter, OpenAI) <code>BALATROLLM_API_KEY</code> API key for your LLM provider <p>For full CLI reference, see CLI Reference.</p>"},{"location":"strategies/","title":"Strategies","text":"<p>Learn how strategies work in BalatroLLM, including their structure, implementation using Jinja2 templates, and how to contribute your own.</p>"},{"location":"strategies/#overview","title":"Overview","text":"<p>Strategies in BalatroLLM define how the LLM bot approaches decision-making during gameplay. Each strategy consists of Jinja2 templates that generate the prompts sent to the language model, along with metadata and configuration files.</p> <p>The strategy system allows for different playing styles - from conservative, financially-disciplined approaches to aggressive, high-risk strategies - by modifying the context, guidance, and available tools provided to the LLM.</p>"},{"location":"strategies/#strategy-structure","title":"Strategy Structure","text":"<p>Each strategy is a directory under <code>src/balatrollm/strategies/</code> containing exactly 5 required files:</p> <pre><code>src/balatrollm/strategies/{strategy_name}/\n\u251c\u2500\u2500 manifest.json          # Strategy metadata\n\u251c\u2500\u2500 STRATEGY.md.jinja      # Strategy-specific guide and approach\n\u251c\u2500\u2500 GAMESTATE.md.jinja     # Game state representation template\n\u251c\u2500\u2500 MEMORY.md.jinja        # Response history tracking template\n\u2514\u2500\u2500 TOOLS.json             # Strategy-specific function definitions\n</code></pre>"},{"location":"strategies/#strategy-naming-requirements","title":"Strategy Naming Requirements","text":"<p>Strategy names must follow these rules:</p> <ul> <li>Lowercase letters and numbers only (e.g., <code>aggressive</code>, <code>value_based</code>, <code>risky2</code>)</li> <li>Valid Python identifier (cannot start with a number)</li> <li>Underscores allowed, hyphens forbidden (e.g., <code>high_risk</code> \u2713, <code>high-risk</code> \u2717)</li> <li>No spaces or special characters</li> </ul>"},{"location":"strategies/#manifestjson","title":"manifest.json","text":"<p>The <code>manifest.json</code> file defines strategy metadata with 5 required fields:</p> <pre><code>{\n  \"name\": \"Default\",\n  \"description\": \"Conservative, financially disciplined approach to Balatro\",\n  \"author\": \"BalatroBench\",\n  \"version\": \"0.1.0\",\n  \"tags\": [\"conservative\", \"financial\"]\n}\n</code></pre>"},{"location":"strategies/#required-fields","title":"Required Fields","text":"<ul> <li>name (string): Human-readable strategy name displayed to users</li> <li>description (string): Brief description of the strategy's approach and philosophy</li> <li>author (string): Author identifier or organization name</li> <li>version (string): Strategy version in semantic versioning format (e.g., \"0.1.0\")</li> <li>tags (array of strings): Categorization tags for filtering and organization</li> </ul>"},{"location":"strategies/#versioning","title":"Versioning","text":"<p>Strategy versions are independent from BalatroLLM versions. Increment the strategy version when making changes:</p> <ul> <li>Patch (0.1.0 \u2192 0.1.1): Bug fixes, typo corrections</li> <li>Minor (0.1.0 \u2192 0.2.0): New features, significant prompt improvements</li> <li>Major (0.1.0 \u2192 1.0.0): Complete strategy overhaul, breaking changes</li> </ul>"},{"location":"strategies/#jinja2-templates","title":"Jinja2 Templates","text":"<p>Strategies use Jinja2 templating to dynamically generate prompts based on the current game state. Templates are compiled at runtime when the bot makes decisions.</p>"},{"location":"strategies/#available-context-variables","title":"Available Context Variables","text":"<p>Each template receives different context variables:</p> <p><code>STRATEGY.md.jinja</code> and <code>GAMESTATE.md.jinja</code>:</p> Variable Type Description <code>G</code> <code>dict</code> Full gamestate dictionary from BalatroBot API <p>The <code>G</code> dictionary contains all game state information including:</p> <ul> <li>Current hand, jokers, consumables</li> <li>Money, remaining hands/discards</li> <li>Blind information, ante level</li> <li>Deck composition, played cards</li> <li>Shop contents (when in SHOP state)</li> <li>And more...</li> </ul> <p>The <code>G</code> dictionary is the Game State returned by the BalatroBot API.</p> <p><code>MEMORY.md.jinja</code>:</p> Variable Type Description <code>history</code> <code>list[dict]</code> Last 10 actions with <code>method</code>, <code>params</code>, <code>reasoning</code> <code>last_error_call_msg</code> <code>str \\| None</code> Error message from invalid LLM response <code>last_failed_call_msg</code> <code>str \\| None</code> Error message from failed API call"},{"location":"strategies/#custom-filters","title":"Custom Filters","text":"<p>The template environment includes a custom <code>from_json</code> filter for parsing JSON strings within templates:</p> <pre><code>{{ some_json_string | from_json }}\n</code></pre>"},{"location":"strategies/#template-files","title":"Template Files","text":""},{"location":"strategies/#strategymdjinja","title":"STRATEGY.md.jinja","text":"<p>Defines the strategy's core philosophy and decision-making approach. This template provides high-level guidance to the LLM about how to play the game.</p> <p>Example structure:</p> <pre><code>You are an expert Balatro player. Analyze the game state and make strategic decisions...\n\n# Strategy Philosophy\n\nYour approach is [conservative/aggressive/balanced]...\n\n# Decision-Making Priorities\n\n1. [Priority 1]\n2. [Priority 2]\n...\n</code></pre>"},{"location":"strategies/#gamestatemdjinja","title":"GAMESTATE.md.jinja","text":"<p>Presents the current game state in a format optimized for LLM comprehension. This template formats all relevant game information.</p> <p>Example access patterns:</p> <pre><code>## Current Situation\n\n- Money: ${{ G.dollars }}\n- Hands remaining: {{ G.hands }}\n- Current score: {{ G.chips }} / {{ G.blind.chips }}\n\n## Your Hand\n\n{% for card in G.hand %}\n- {{ card.rank }} of {{ card.suit }}\n{% endfor %}\n</code></pre>"},{"location":"strategies/#memorymdjinja","title":"MEMORY.md.jinja","text":"<p>Tracks previous actions and errors to provide context for decision-making. This template helps the LLM learn from mistakes and maintain consistency.</p> <p>Context variables (see Available Context Variables for details):</p> <ul> <li><code>history</code>: List of previous actions (last 10)</li> <li><code>last_error_call_msg</code>: Error from invalid LLM response</li> <li><code>last_failed_call_msg</code>: Error from failed API call</li> </ul>"},{"location":"strategies/#toolsjson","title":"TOOLS.json","text":"<p>Defines the function calls available to the LLM during different game phases. The structure maps game states to available tools:</p> <pre><code>{\n  \"SELECTING_HAND\": [\n    {\n      \"type\": \"function\",\n      \"function\": {\n        \"name\": \"play_hand_or_discard\",\n        \"description\": \"Play cards as a poker hand or discard them\",\n        \"parameters\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"action\": {\n              \"type\": \"string\",\n              \"enum\": [\"play_hand\", \"discard\"]\n            },\n            \"cards\": {\n              \"type\": \"array\",\n              \"items\": {\"type\": \"integer\"}\n            }\n          },\n          \"required\": [\"action\", \"cards\"]\n        }\n      }\n    }\n  ],\n  \"SHOP\": [...]\n}\n</code></pre>"},{"location":"strategies/#available-game-states","title":"Available Game States","text":"<p>Tools are organized by game state. The <code>TOOLS.json</code> file maps each state to its available tools.</p> Game State Description Available Tools <code>SELECTING_HAND</code> Hand selection phase <code>play</code>, <code>discard</code>, <code>rearrange</code>, <code>sell</code>, <code>use</code> <code>SHOP</code> Shop phase <code>buy</code>, <code>reroll</code>, <code>next_round</code>, <code>sell</code>, <code>use</code>, <code>rearrange</code> <code>BLIND_SELECT</code> Blind selection phase <code>select</code>, <code>skip</code> <code>SMODS_BOOSTER_OPENED</code> Pack opening phase <code>pack</code> (select cards or skip) <p>BLIND_SELECT and ROUND_EVAL Behavior</p> <p>The current <code>balatrollm</code> bot loop does not delegate <code>BLIND_SELECT</code> or <code>ROUND_EVAL</code> to the LLM (see <code>src/balatrollm/bot.py</code>).</p> <ul> <li><code>ROUND_EVAL</code> always calls <code>cash_out</code></li> <li><code>BLIND_SELECT</code> always calls <code>select</code> (never <code>skip</code>) because Tags are not supported yet by <code>balatrobot</code>; skipping blinds would collect Tags the bot can't use</li> </ul> <p>This \"always play the blind\" policy is a reasonable baseline for <code>RED</code> deck on <code>WHITE</code> stake.</p>"},{"location":"strategies/#common-tools","title":"Common Tools","text":"<p>SELECTING_HAND phase:</p> <ul> <li><code>play</code>: Play selected cards as a poker hand</li> <li><code>discard</code>: Discard selected cards</li> <li><code>rearrange</code>: Reorder cards in hand or jokers</li> <li><code>sell</code>: Sell a joker or consumable for money</li> <li><code>use</code>: Use a Tarot/Planet/Spectral card</li> </ul> <p>SHOP phase:</p> <ul> <li><code>buy</code>: Purchase a card, joker, or pack</li> <li><code>reroll</code>: Reroll the shop</li> <li><code>next_round</code>: Proceed to next round</li> <li><code>sell</code>: Sell a joker or consumable</li> <li><code>use</code>: Use a consumable</li> <li><code>rearrange</code>: Reorder jokers</li> </ul> <p>BLIND_SELECT phase:</p> <ul> <li><code>select</code>: Select a blind to play</li> <li><code>skip</code>: Skip the current blind (if allowed). (Currently not used by <code>balatrollm</code>; Tag handling isn\u2019t supported yet.)</li> </ul>"},{"location":"strategies/#strategy-validation","title":"Strategy Validation","text":"<p>BalatroLLM performs two-stage validation when loading strategies:</p> <ol> <li> <p>Template Validation (via <code>StrategyManager</code>):</p> <ul> <li>Verifies all 4 template files exist (STRATEGY.md.jinja, GAMESTATE.md.jinja, MEMORY.md.jinja, TOOLS.json)</li> <li>Raises <code>FileNotFoundError</code> if any template file is missing</li> </ul> </li> <li> <p>Metadata Validation (via <code>StrategyManifest</code>):</p> <ul> <li>Verifies manifest.json exists</li> <li>Validates all 5 required fields are present</li> <li>Raises <code>FileNotFoundError</code> if manifest.json is missing</li> <li>Raises <code>ValueError</code> if required fields are missing</li> </ul> </li> </ol> <p>Validation occurs at runtime when a strategy is selected.</p>"},{"location":"strategies/#contributing-your-own-strategy","title":"Contributing Your Own Strategy","text":""},{"location":"strategies/#1-study-existing-strategies","title":"1. Study Existing Strategies","text":"<p>Review the built-in default strategy (<code>src/balatrollm/strategies/default/</code>) to understand structure and best practices.</p>"},{"location":"strategies/#2-create-strategy-directory","title":"2. Create Strategy Directory","text":"<pre><code>mkdir src/balatrollm/strategies/your_strategy_name\n</code></pre>"},{"location":"strategies/#3-create-required-files","title":"3. Create Required Files","text":"<p>Create all 5 required files using existing strategies as templates:</p> <ol> <li>manifest.json: Define metadata</li> <li>STRATEGY.md.jinja: Define strategy philosophy and approach</li> <li>GAMESTATE.md.jinja: Format game state presentation</li> <li>MEMORY.md.jinja: Format response history</li> <li>TOOLS.json: Define available functions (usually copied from existing strategies)</li> </ol>"},{"location":"strategies/#4-test-locally","title":"4. Test Locally","text":"<p>Test your strategy to ensure it works correctly:</p> <pre><code>balatrollm --strategy your_strategy_name\n</code></pre> <p>Common issues:</p> <ul> <li>Jinja2 syntax errors in templates</li> <li>Missing required fields in manifest.json</li> <li>Invalid JSON in TOOLS.json</li> <li>File naming mismatches</li> </ul>"},{"location":"strategies/#5-submit-pull-request","title":"5. Submit Pull Request","text":"<ol> <li>Fork the BalatroLLM repository</li> <li>Create a feature branch: <code>git checkout -b feat/add-strategy-your_strategy_name</code></li> <li>Add your strategy directory with all required files</li> <li>Commit following conventional commits: <code>feat(strategy): add [strategy_name] strategy</code></li> <li>Open a pull request with:<ul> <li>Clear title describing your strategy</li> <li>Brief description of the strategy's approach</li> <li>Any notable differences from existing strategies</li> </ul> </li> </ol>"},{"location":"strategies/#quality-standards","title":"Quality Standards","text":"<p>Submissions must meet these standards:</p> <ul> <li>Complete: All 5 files present and functional</li> <li>Valid: Templates compile without errors, JSON is well-formed</li> <li>Documented: Clear strategy philosophy and decision-making approach</li> <li>Unique: Offers meaningfully different gameplay from existing strategies</li> <li>Tested: Locally verified to work</li> </ul>"},{"location":"strategies/#review-process","title":"Review Process","text":"<p>Strategy contributions are reviewed for:</p> <ul> <li>Compliance with naming and structure requirements</li> <li>Template functionality and Jinja2 compatibility</li> <li>Manifest.json completeness and validity</li> <li>Strategy uniqueness and gameplay value</li> <li>Code quality and documentation clarity</li> </ul> <p>Once approved, your strategy will be available to all BalatroLLM users via the <code>--strategy</code> flag.</p>"},{"location":"strategies/#best-practices","title":"Best Practices","text":""},{"location":"strategies/#template-design","title":"Template Design","text":"<ul> <li>Be concise: LLMs work better with clear, focused prompts</li> <li>Provide context: Include relevant game information without overwhelming</li> <li>Use formatting: Headers, lists, and emphasis help LLM comprehension</li> <li>Test iteratively: Run games and refine based on bot behavior</li> </ul>"},{"location":"strategies/#strategy-philosophy","title":"Strategy Philosophy","text":"<ul> <li>Define clear priorities: What matters most? (economy, joker synergies, risk management)</li> <li>Explain trade-offs: Help the LLM understand when to break rules</li> <li>Provide examples: Concrete scenarios guide decision-making</li> <li>Stay consistent: Maintain the same approach throughout templates</li> </ul>"}]}