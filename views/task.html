<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task Overlay</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white w-[1120px] h-[400px] flex items-center">
  <div id="overlay" class="w-full h-full flex justify-between items-center px-8 border-2 border-gray-600 rounded-lg">
    <div id="model" class="font-mono text-3xl">
      <span class="text-gray-500">Loading...</span>
    </div>
    <div class="font-mono text-3xl"><span class="text-gray-500">seed </span><span id="seed" class="text-white"></span></div>
  </div>

  <script>
    let lastTask = null;

    async function fetchTask() {
      try {
        const latestRes = await fetch('../../runs/latest.json?' + Date.now());
        if (!latestRes.ok) return;
        const latest = await latestRes.json();

        const taskRes = await fetch('../../runs/' + latest.task + '?' + Date.now());
        if (!taskRes.ok) return;
        const task = await taskRes.json();

        const taskKey = task.model.vendor + task.model.name + task.seed;
        if (taskKey !== lastTask) {
          document.getElementById('model').innerHTML = 
            `<span class="text-white">${task.model.vendor}</span>` +
            `<span class="text-gray-500"> / </span>` +
            `<span class="text-white">${task.model.name}</span>`;
          document.getElementById('seed').textContent = task.seed;
          lastTask = taskKey;
        }
      } catch (e) {
        // Ignore fetch errors
      }
    }

    fetchTask();
    setInterval(fetchTask, 3000);
  </script>
</body>
</html>
