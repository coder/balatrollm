# Current Game State

{% if game_state.state == 7 -%}
- **Phase**: Blind Select Phase
- **Round**: {{ game_state.game.round }}
- **Ante**: {{ 1 if (game_state.game.round == 0) else ((game_state.game.round - 1) // 3) + 1 }}/8
- **Money**: ${{ game_state.game.dollars }}
{% elif game_state.state == 1 -%}
- **Phase**: Playing Phase
- **Round**: {{ game_state.game.round }}
- **Ante**: {{ 1 if (game_state.game.round == 0) else ((game_state.game.round - 1) // 3) + 1 }}/8
- **Money**: ${{ game_state.game.dollars }}
- **Hands left**: {{ game_state.game.current_round.hands_left}} / {{ game_state.game.current_round.hands_left + game_state.game.current_round.hands_played}}
- **Discards left**: {{ game_state.game.current_round.discards_left }} / {{ game_state.game.current_round.discards_left + game_state.game.current_round.discards_used }}
{% elif game_state.state == 8 -%}
- **Phase**: Round Evaluation Phase
- **Round**: {{ game_state.game.round }}
- **Ante**: {{ 1 if (game_state.game.round == 0) else ((game_state.game.round - 1) // 3) + 1 }}/8
- **Money**: ${{ game_state.game.dollars }}
{% elif game_state.state == 5 -%}
- **Phase**: Shop Phase
- **Round**: {{ game_state.game.round }}
- **Ante**: {{ 1 if (game_state.game.round == 0) else ((game_state.game.round - 1) // 3) + 1 }}/8
- **Money**: ${{ game_state.game.dollars }}
{% endif -%}

## Jokers

The current Jokers count is {{ game_state.jokers.config.card_count }} / {{ game_state.jokers.config.card_limit }}

{% for j in game_state.jokers.cards -%}
{% if j.facing == "front" -%}
- {{ loop.index0 }}: {{ j.label }} ({{ constants.jokers[j.config.center_key] }})
  - **Sell value**: {{ j.sell_cost }}
{% if j.edition %}
  - **{{ j.edition.type|title }} Edition**: {{ constants.editions[j.edition.key] }}
{% endif -%}
{% if j.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{% endif -%}
{% else %}
- {{ loop.index0 }}: the joker is face down
{% endif -%}
{% endfor -%}

## Consumables

The current Consumables count is {{ game_state.consumables.config.card_count }} / {{ game_state.consumables.config.card_limit }}

{% for c in game_state.consumables.cards -%}
{% if c.facing == "front" -%}
- {{ loop.index0 }}: {{ c.label }} ({{ constants.consumables[c.config.center_key] }})
  - **Sell value**: {{ c.sell_cost }}
{% if c.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{% endif -%}
{% else %}
- {{ loop.index0 }}: the joker is face down
{% endif -%}
{% endfor -%}

{% if game_state.used_vouchers|length > 0 -%}
## Vouchers

Here is the list of vouchers redeemed during the run:

{% for v in game_state.used_vouchers.keys() -%}
- {{ constants.vouchers[v] }}
{% endfor -%}
{% endif -%}

{% if game_state.tags|length > 0 -%}
## Tags

Here is the list of tags you have accumulated so far:

{% for t in game_state.tags -%}
- {{ constants.tags[t] }}
{% endfor -%}
{% endif -%}

## Poker Hands

Here is a list of the poker hands and their levels:

{% for name, hand in game_state.game.hands | dictsort -%}
- **{{ name }}** (Level {{ hand.level }}):
  - **Chips**: {{ hand.chips }} (Base: {{ hand.s_chips }})
  - **Mult**: {{ hand.mult }} (Base: {{ hand.s_mult }})
  - **Example**: `{% for c in hand.example %}{{ c[0] }}{% if not c[1] %} (not scored){% endif %}{% if not loop.last %}, {% endif %}{% endfor %}`
{% endfor -%}

{% if game_state.state == 7 -%}
## Blind Select Game State

- **Small Blind**:
  - **target score**: {{ game_state.blinds.small.score }}
  - **status**: {{ game_state.blinds.small.status }}
  - **tag name**: {{ game_state.blinds.small.tag_name }}
  - **tag effect**: {{ game_state.blinds.small.tag_effect }}

- **Big Blind**:
  - **target score**: {{ game_state.blinds.big.score }}
  - **status**: {{ game_state.blinds.big.status }}
  - **tag name**: {{ game_state.blinds.big.tag_name }}
  - **tag effect**: {{ game_state.blinds.big.tag_effect }}

- **Boss Blind**:
  - **target score**: {{ game_state.blinds.boss.score }}
  - **status**: {{ game_state.blinds.boss.status }}
  - **name**: {{ game_state.blinds.boss.name }}
  - **effect**: {{ game_state.blinds.boss.effect }}
{% endif %}

{% if game_state.state == 1 -%}
## Current Hand

The current card count is {{ game_state.hand.config.card_count }} / {{ game_state.hand.config.card_limit }}
You can play or discard up to {{ game_state.hand.config.card_limit }} cards.

{% for c in game_state.hand.cards -%}
{% if c.facing == "front" -%}
{% if c.ability.name == "Stone Card" -%}
- {{ loop.index0 }}: ??? of ???
{% else %}
- {{ loop.index0 }}: {{ c.config.card.value }} of {{ c.config.card.suit }} (`{{ c.config.card_key }}`)
{% if c.edition %}
  - **{{ c.edition.type|title }} Edition**: {{ constants.editions[c.edition.key] }}
{% endif -%}
{% if c.ability.set == "Enhanced" %}
  - **{{c.ability.name}}**: {{ constants.enhancements['m_' + c.ability.name.lower().replace(' card', '').replace(' ', '_')] }}
{% endif -%}
{% if c.seal %}
  - **{{ c.seal }} seal**: {{ constants.seals[c.seal] }}
{% endif -%}
{% if c.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{% endif -%}
{% endif -%}
{% else %}
- {{ loop.index0 }}: the card is face down
{% endif -%}
{% endfor %}
{% endif -%}

{% if game_state.state == 5 -%}
## Shop

TODO

{% endif -%}

# Tools available

You **MUST** use one of the following tools to perform the intended action:

{% if game_state.state == 7 -%}
- Select or skip the current blind
  - Function: `skip_or_select_blind`
  - Parameters:
    - `action`: (string) `select` or `skip`
    - `reasoning`: (string) Strategic reasoning for selecting or skipping the blind
{% elif game_state.state == 1 -%}
- Play a Hand or Discard cards
  - Function: `play_hand_or_discard`
  - Parameters:
    - `action`: (string) `play_hand` or `discard`
    - `cards`: (list) List of 0-indexed card positions to play or discard
    - `reasoning`: (string) A quick reasoning for play or discard the cards
- Rearrange the cards in your current hand
  - Function: `rearrange_hand`
  - Parameters:
    - `cards`: (list) List of 0-indexed card positions in desired new order (must include all cards)
    - `reasoning`: (string) Reasoning for this specific arrangement
{% elif game_state.state == 8 -%}
- Cash out the reward money for the current round
  - Function: `cash_out`
  - Parameters:
    - `reasoning`: (string) Brief reflection on the round performance
{% elif game_state.state == 5 -%}
- Spend money in the shop
  - Function: `shop`
  - Parameters:
    - `action`: (string) `next_round`, `reroll`, `buy_card`, or `redeem_voucher`
    - `index`: (integer) 0-indexed position in the relevant shop area (required for buy_card)
    - `reasoning`: (string) Strategic reasoning for this shop action
{% endif %}
- Sell a Joker
  - Function: `sell_joker`
  - Parameters:
    - `index`: (integer) 0-indexed position of the joker to sell
    - `reasoning`: (string) Strategic reasoning for selling this specific joker
- Sell a Consumable
  - Function: `sell_consumable`
  - Parameters:
    - `index`: (integer) 0-indexed position of the consumable to sell
    - `reasoning`: (string) Strategic reasoning for selling this consumable
- Use a Consumable
  - Function: `use_consumable`
  - Parameters:
    - `index`: (integer) 0-indexed position of the consumable to use
    - reasoning: (string) Strategic reasoning for using this consumable now
