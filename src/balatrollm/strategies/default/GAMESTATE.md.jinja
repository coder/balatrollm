# Current Game State

{% if G.state == 1 -%}
- **Phase**: Playing Phase (gamestate is SELECTING_HAND)
- **Round**: {{ G.game.round }}
- **Ante**: {{ G.game.round_resets.ante }}/8
- **Money**: ${{ G.game.dollars }}
- **Hands left**: {{ G.game.current_round.hands_left}}/{{ G.game.current_round.hands_left + G.game.current_round.hands_played}}
- **Discards left**: {{ G.game.current_round.discards_left }}/{{ G.game.current_round.discards_left + G.game.current_round.discards_used }}
- **Current Blind**: {% if G.blinds.small.status == "Current" %}Small{% elif G.blinds.big.status == "Current" %}Big{% elif G.blinds.boss.status == "Current" %}Boss ({{G.blinds.boss.name}}: {{G.blinds.boss.effect}}){% endif %}
- **Target Score**: {% if G.blinds.small.status == "Current" %}{{ G.blinds.small.score }}{% elif G.blinds.big.status == "Current" %}{{ G.blinds.big.score }}{% elif G.blinds.boss.status == "Current" %}{{ G.blinds.boss.score }}{% endif %}
- **Current Score**: {{ G.game.chips }}
{%- elif G.state == 5 %}
- **Phase**: Shop Phase (gamestate is SHOP)
- **Round**: {{ G.game.round }}
- **Ante**: {{ G.game.round_resets.ante }}/8
- **Money**: ${{ G.game.dollars }}
{%- endif %}

## Jokers

The current Jokers count is {{ G.jokers.config.card_count }}/{{ G.jokers.config.card_limit }}.
{% for j in G.jokers.cards -%}
{% if j.facing == "front" %}
- {{ loop.index0 }}: {{ j.label }} ({{ constants.jokers[j.config.center_key] }})
  - **Sell value**: {{ j.sell_cost }}
{%- if j.edition %}
  - **{{ j.edition.type|title }} Edition**: {{ constants.editions[j.edition.key] }}
{%- endif %}
{%- if j.debuff %}
  - **Debuff**: this joker is debuffed so its effect is disabled
{%- endif%}
{%- else %}
- {{ loop.index0 }}: the joker is face down
{%- endif %}
{%- endfor %}

## Consumables

The current Consumables count is {{ G.consumables.config.card_count }}/{{ G.consumables.config.card_limit }}.
{% for c in G.consumables.cards -%}
{% if c.facing == "front" %}
- {{ loop.index0 }}: {{ c.label }} ({{ constants.consumables[c.config.center_key] }})
  - **Sell value**: {{ c.sell_cost }}
{%- if c.debuff %}
  - **Debuff**: this consumable is debuffed so its effect is disabled
{%- endif %}
{%- else %}
- {{ loop.index0 }}: the consumable is face down
{%- endif %}
{%- endfor %}

{% if G.game.used_vouchers|length > 0 -%}
## Vouchers

Here is the list of vouchers redeemed during the run:

{% for v, redeemed in G.game.used_vouchers.items() -%}
{% if redeemed -%}
- {{ v }}: {{ constants.vouchers[v] }}
{% endif -%}
{% endfor -%}
{% endif -%}

## Poker Hands

Here is a list of the poker hands and their levels:

{% for name, hand in G.game.hands.items() | sort(attribute='1.order') -%}
- **{{ name }}** (Level {{ hand.level }}):
  - **Chips**: {{ hand.chips }}
  - **Mult**: {{ hand.mult }}
  - **Example**: `{% for c in hand.example %}{{ c[0] }}{% if not c[1] %} (not scored){% endif %}{% if not loop.last %}, {% endif %}{% endfor %}`
  - During this run you have played {{ name }} {{ hand.played }} times, {{ hand.played_this_round }} of which were played this round.
{% endfor %}

{% if G.state == 1 -%}
## Current Hand

The current card count is {{ G.hand.config.card_count }} / {{ G.hand.config.card_limit }}
**CRITICAL LIMIT: You can play or discard MAXIMUM {{ G.hand.config.highlighted_limit }} cards per action - NEVER MORE THAN {{ G.hand.config.highlighted_limit }} CARDS (this is an absolute game rule).**

{% for c in G.hand.cards %}
{%- if c.facing == "front" %}
{%- if c.ability.name == "Stone Card" %}
- {{ loop.index0 }}: this is a stone card (no suit and no rank)
{%- elif c.config.card %}
- {{ loop.index0 }}: {{ c.config.card.value }} of {{ c.config.card.suit }} (`{{ c.config.card_key }}`)
{%- if c.edition %}
  - **{{ c.edition.type|title }} Edition**: {{ constants.editions[c.edition.key] }}
{%- endif %}
{%- if c.ability.set == "Enhanced" %}
  - **{{c.ability.name}}**: {{ constants.enhancements['m_' + c.ability.name.lower().replace(' card', '').replace(' ', '_')] }}
{%- endif %}
{%- if c.seal %}
  - **{{ c.seal }} seal**: {{ constants.seals[c.seal] }}
{%- endif %}
{%- if c.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{%- endif %}
{%- else %}
- {{ loop.index0 }}: {{ c.label if c.label else "Unknown card" }}
{%- if c.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{%- endif %}
{%- endif %}
{%- else %}
- {{ loop.index0 }}: the card is face down
{%- endif %}
{%- endfor %}
{%- endif %}

{% if G.state == 5 -%}
## Shop

Here are the available cards in the shop:

{% for card in G.shop_jokers.cards -%}
{% if card.facing == "front" %}
{%- if card.ability.set == "Joker" %}
- {{ loop.index0 }}: {{ card.label }} ({{ constants.jokers[card.config.center_key] }})
  - **Set**: {{ card.ability.set }}
  - **Cost**: ${{ card.cost }}
  - **Sell value**: ${{ card.sell_cost }}
{%- if card.edition %}
  - **{{ card.edition.type|title }} Edition**: {{ constants.editions[card.edition.key] }}
{%- endif %}
{%- if card.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{%- endif %}
{%- elif card.ability.set in ["Tarot", "Planet", "Spectral"] %}
- {{ loop.index0 }}: {{ card.label }} ({{ constants.consumables[card.config.center_key] }})
  - **Set**: {{ card.ability.set }}
  - **Cost**: ${{ card.cost }}
  - **Sell value**: ${{ card.sell_cost }}
{%- if card.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{%- endif %}
{%- else %}
{%- if card.ability.name == "Stone Card" %}
- {{ loop.index0 }}: this is a stone card (no suit and no rank)
  - **Set**: {{ card.ability.set }}
  - **Cost**: ${{ card.cost }}
  - **Sell value**: ${{ card.sell_cost }}
{%- else %}
{%- if card.config.card %}
- {{ loop.index0 }}: {{ card.config.card.value }} of {{ card.config.card.suit }} (`{{ card.config.card_key }}`)
  - **Set**: {{ card.ability.set }}
  - **Cost**: ${{ card.cost }}
  - **Sell value**: ${{ card.sell_cost }}
{%- if card.edition %}
  - **{{ card.edition.type|title }} Edition**: {{ constants.editions[card.edition.key] }}
{%- endif %}
{%- if card.ability.set == "Enhanced" %}
  - **{{card.ability.name}}**: {{ constants.enhancements['m_' + card.ability.name.lower().replace(' card', '').replace(' ', '_')] }}
{%- endif %}
{%- if card.seal %}
  - **{{ card.seal }} seal**: {{ constants.seals[card.seal] }}
{%- endif %}
{%- if card.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{%- endif %}
{%- else %}
- {{ loop.index0 }}: {{ card.label }} ({{ card.ability.set if card.ability.set else "Unknown" }})
  - **Set**: {{ card.ability.set }}
  - **Cost**: ${{ card.cost }}
  - **Sell value**: ${{ card.sell_cost }}
{%- if card.edition %}
  - **{{ card.edition.type|title }} Edition**: {{ constants.editions[card.edition.key] }}
{%- endif %}
{%- if card.debuff %}
  - **Debuff**: this card is debuffed and will not be counted in scoring
{%- endif %}
{%- endif %}
{%- endif %}
{%- endif %}
{%- else %}
- {{ loop.index0 }}: the card is face down
{%- endif %}
{%- endfor %}

The cost of the reroll is ${{ G.game.current_round.reroll_cost }}.

Here are the vouchers that can be redeemed:
{% for voucher in G.shop_vouchers.cards -%}
{%- if voucher.facing == "front" %}
- {{ loop.index0 }}: {{ voucher.label }} ({{ constants.vouchers[voucher.config.center_key] }})
  - **Cost**: ${{ voucher.cost }}
  - **Sell value**: ${{ voucher.sell_cost }}
{%- else %}
- {{ loop.index0 }}: the voucher is face down
{%- endif %}
{%- endfor %}

{#- Here are the booster packs that can be opened:

{% for pack in G.shop_booster.cards -%}
- {{ loop.index0 }}: {{ pack.label }}
  - **Cost**: ${{ pack.cost }}
  - **Sell value**: ${{ pack.sell_cost }}
{% endfor %} -#}
{%- endif %}

# Tools available

You **MUST** use one of the following tools to perform the intended action:

{% if G.state == 1 -%}
- Play a Hand or Discard cards
  - Function: `play_hand_or_discard`
  - Parameters:
    - `action`: (string) `play_hand` or `discard`
    - `cards`: (list) List of 0-indexed card positions to play or discard
    - `reasoning`: (string) A quick reasoning for play or discard the cards
- Rearrange the cards in your current hand
  - Function: `rearrange_hand`
  - Parameters:
    - `cards`: (list) List of 0-indexed card positions in desired new order (must include all cards)
    - `reasoning`: (string) Reasoning for this specific arrangement
{% elif G.state == 5 -%}
- Spend money in the shop
  - Function: `shop`
  - Parameters:
    - `action`: (string) `next_round`, `reroll`, `buy_card`, or `redeem_voucher`
    - `index`: (integer) 0-indexed position in the relevant shop area (required for buy_card)
    - `reasoning`: (string) Strategic reasoning for this shop action
{% endif -%}
- Sell a Joker
  - Function: `sell_joker`
  - Parameters:
    - `index`: (integer) 0-indexed position of the joker to sell
    - `reasoning`: (string) Strategic reasoning for selling this specific joker
- Sell a Consumable
  - Function: `sell_consumable`
  - Parameters:
    - `index`: (integer) 0-indexed position of the consumable to sell
    - `reasoning`: (string) Strategic reasoning for selling this consumable
- Use a Consumable
  - Function: `use_consumable`
  - Parameters:
    - `index`: (integer) 0-indexed position of the consumable to use
    - `cards`: (list) List of 0-indexed card positions to select for activate the consumable effect if required
    - `reasoning`: (string) Strategic reasoning for using this consumable now
